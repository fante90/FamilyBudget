function _defineProperties(t,e){for(var l=0;l<e.length;l++){var n=e[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,l){return e&&_defineProperties(t.prototype,e),l&&_defineProperties(t,l),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{p9XQ:function(t,e,l){"use strict";l.r(e);var n=l("8Y7J"),a=function t(){_classCallCheck(this,t)},o=l("pMnS"),i=l("UMKc"),r=l("MKJQ"),s=l("sZkV"),u=l("hrZj"),c=l("aILq"),d=l("qyxE"),p=l("Witw"),b=l("bBk2"),h=l("A1CT"),y=l("MO+k"),f=function(){function t(e,l,n){_classCallCheck(this,t),this.uiService=e,this.appDBService=l,this.utilityService=n,this.chartFilterModel={fromDate:null,toDate:null,dateRange:"YEAR"},this.chartRefOut=null,this.chartRefIn=null,this.chartSliderOpts={initialSlide:0,speed:400}}return _createClass(t,[{key:"refreshChart",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l={entity:d.a.entityName,date:{$gte:this.utilityService.dateToISO(this.chartFilterModel.fromDate),$lte:this.utilityService.dateToISO(this.chartFilterModel.toDate)}};d.a.getEntries(this.appDBService,!1,null,l).then((function(l){var n=l,a=[];if("YEAR"===t.chartFilterModel.dateRange)a=["Ge","Fe","Ma","Ap","Ma","Gi","Lu","Ag","Se","Ot","No","Di"];else if("MONTH"===t.chartFilterModel.dateRange)for(var o=0;o<new Date(t.chartFilterModel.toDate).getDate();o++)a.push(""+(o+1));else a=["Lu","Ma","Me","Gi","Ve","Sa","Do"];var i=[],r=[],s=[],u=[];n.forEach((function(e){if(u.indexOf(e.id_category)<0&&s.indexOf(e.id_category)<0){var l={label:e.category.description,backgroundColor:e.category.color,data:[]};a.forEach((function(){l.data.push(0)})),"P"===e.category.type?(r.push(l),u.push(e.id_category)):(i.push(l),s.push(e.id_category))}var n;if(n="P"===e.category.type?u.indexOf(e.id_category):s.indexOf(e.id_category),"YEAR"===t.chartFilterModel.dateRange){var o=new Date(e.date).getMonth();"P"===e.category.type?r[n].data[o]+=e.value:i[n].data[o]+=e.value}else if("MONTH"===t.chartFilterModel.dateRange){var c=new Date(e.date).getDate();"P"===e.category.type?r[n].data[c]+=e.value:i[n].data[c]+=e.value}else{var d=new Date(e.date).getDay()-1;d<0&&(d=6),"P"===e.category.type?r[n].data[d]+=e.value:i[n].data[d]+=e.value}})),t.chartRefIn&&t.chartRefIn.destroy(),t.chartRefOut&&t.chartRefOut.destroy(),t.chartRefIn=new y.Chart(t.statsInChart.nativeElement,{type:"bar",data:{labels:a,datasets:r},options:{legend:{display:!1},tooltips:{enabled:!1,mode:"index",position:"nearest",custom:t.customTooltips},maintainAspectRatio:!1,responsive:!0,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{display:!1}}]}}}),t.chartRefOut=new y.Chart(t.statsOutChart.nativeElement,{type:"bar",data:{labels:a,datasets:i},options:{legend:{display:!1},tooltips:{enabled:!1,mode:"index",position:"nearest",custom:t.customTooltips},maintainAspectRatio:!1,responsive:!0,scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0,ticks:{display:!1}}]}}}),e&&e.target.complete()}))}},{key:"dateFilterChanged",value:function(t){this.chartFilterModel.fromDate=t.start.toISOString(),this.chartFilterModel.toDate=t.end.toISOString(),this.chartFilterModel.dateRange=t.range,this.refreshChart()}},{key:"slideNext",value:function(){}},{key:"slidePrev",value:function(){}},{key:"customTooltips",value:function(t){var e=document.getElementById("chartjs-tooltip");if(e||((e=document.createElement("div")).id="chartjs-tooltip",e.innerHTML="<table></table>",document.getElementById("ionContent").appendChild(e),e=document.getElementById("chartjs-tooltip")),0!==t.opacity){if(e.classList.remove("above","below","no-transform"),e.classList.add(t.yAlign?t.yAlign:"no-transform"),t.body){var l=t.title||[],n=t.body.map((function(t){return t.lines})),a="<thead>";l.forEach((function(t){a+="<tr><th>"+t+"</th></tr>"})),a+="</thead><tbody>",n.forEach((function(e,l){var n=t.labelColors[l],o="background:"+n.backgroundColor;o+="; border-color:"+n.borderColor;var i='<span class="chartjs-tooltip-key" style="'+(o+="; border-width: 2px")+'"></span>',r=e[0].split(":");a+="<tr><td>"+i+r[0]+": "+parseFloat(r[1].trim()).toFixed(2)+"&euro;</td></tr>"})),a+="</tbody>",e.querySelector("table").innerHTML=a}e.style.opacity="1",e.style.left=t.x+"px",e.style.top=t.y+"px",e.style.fontFamily=t._bodyFontFamily,e.style.fontSize=t.bodyFontSize+"px",e.style.fontStyle=t._bodyFontStyle,e.style.padding=t.yPadding+"px "+t.xPadding+"px"}else e.style.opacity=0}}]),t}(),g=n.nb({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}ion-slides[_ngcontent-%COMP%]{height:100%}"]],data:{}});function v(t){return n.Kb(0,[n.Gb(671088640,1,{statsOutChart:0}),n.Gb(671088640,2,{statsInChart:0}),(t()(),n.pb(2,0,null,null,9,"div",[],null,null,null,null,null)),(t()(),n.pb(3,0,null,null,6,"ion-list",[["mode","ios"]],null,null,null,r.rb,r.x)),n.ob(4,49152,null,0,s.O,[n.h,n.k,n.x],{mode:[0,"mode"]},null),(t()(),n.pb(5,0,null,0,4,"ion-list-header",[],null,null,null,r.qb,r.y)),n.ob(6,49152,null,0,s.P,[n.h,n.k,n.x],null,null),(t()(),n.pb(7,0,null,0,2,"ion-label",[["class","ion-no-margin"]],null,null,null,r.pb,r.w)),n.ob(8,49152,null,0,s.N,[n.h,n.k,n.x],null,null),(t()(),n.Ib(-1,0,["Statistiche"])),(t()(),n.pb(10,0,null,null,1,"app-fb-date-filter-toolbar",[],null,[[null,"changed"]],(function(t,e,l){var n=!0;return"changed"===e&&(n=!1!==t.component.dateFilterChanged(l)&&n),n}),u.b,u.a)),n.ob(11,114688,null,0,c.a,[s.Jb,n.h,n.x],null,{changed:"changed"}),(t()(),n.pb(12,0,null,null,9,"ion-content",[["id","ionContent"]],null,null,null,r.cb,r.j)),n.ob(13,49152,null,0,s.u,[n.h,n.k,n.x],null,null),(t()(),n.pb(14,0,null,0,7,"ion-slides",[["pager","false"]],null,[[null,"ionSlideNextEnd"],[null,"ionSlidePrevEnd"]],(function(t,e,l){var n=!0,a=t.component;return"ionSlideNextEnd"===e&&(n=!1!==a.slideNext()&&n),"ionSlidePrevEnd"===e&&(n=!1!==a.slidePrev()&&n),n}),r.Cb,r.J)),n.ob(15,49152,null,0,s.ob,[n.h,n.k,n.x],{options:[0,"options"],pager:[1,"pager"]},null),(t()(),n.pb(16,0,null,0,2,"ion-slide",[],null,null,null,r.Bb,r.I)),n.ob(17,49152,null,0,s.nb,[n.h,n.k,n.x],null,null),(t()(),n.pb(18,0,[[1,0],["statsOutChart",1]],0,0,"canvas",[],null,null,null,null,null)),(t()(),n.pb(19,0,null,0,2,"ion-slide",[],null,null,null,r.Bb,r.I)),n.ob(20,49152,null,0,s.nb,[n.h,n.k,n.x],null,null),(t()(),n.pb(21,0,[[2,0],["statsInChart",1]],0,0,"canvas",[],null,null,null,null,null))],(function(t,e){var l=e.component;t(e,4,0,"ios"),t(e,11,0),t(e,15,0,l.chartSliderOpts,"false")}),null)}var m=n.lb("app-stats",f,(function(t){return n.Kb(0,[(t()(),n.pb(0,0,null,null,1,"app-stats",[],null,null,null,v,g)),n.ob(1,49152,null,0,f,[p.a,b.a,h.a],null,null)],null,null)}),{},{},[]),x=l("SVse"),k=l("s7LF"),C=l("iInd"),S=l("0Rqu");l.d(e,"StatsPageModuleNgFactory",(function(){return M}));var M=n.mb(a,[],(function(t){return n.yb([n.zb(512,n.j,n.X,[[8,[o.a,i.a,m]],[3,n.j],n.v]),n.zb(4608,x.m,x.l,[n.s,[2,x.x]]),n.zb(4608,s.c,s.c,[n.x,n.g]),n.zb(4608,s.Eb,s.Eb,[s.c,n.j,n.p]),n.zb(4608,s.Jb,s.Jb,[s.c,n.j,n.p]),n.zb(4608,k.l,k.l,[]),n.zb(1073742336,x.b,x.b,[]),n.zb(1073742336,s.Bb,s.Bb,[]),n.zb(1073742336,k.k,k.k,[]),n.zb(1073742336,k.b,k.b,[]),n.zb(1073742336,C.o,C.o,[[2,C.t],[2,C.m]]),n.zb(1073742336,S.a,S.a,[]),n.zb(1073742336,a,a,[]),n.zb(1024,C.k,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);